Le dossier home de ce niveau contient un fichier level11.lua. Nous avons egalement pu constater precedemment, grace a des commandes ps -aux, qu'un processus tourne en fond correspondant a un serveur en lua. Il s'agit bien du fichier que nous avons ici.
Celui-ci ecoute sur le port 5151 : nous pouvons donc nous y connecter avec netcat, grace a la commande
nc localhost 5151
Le serveur demande ensuite un mot de passe. En obervant le code fu fichier lua, nous observons que le serveur recupere l'input donné apres sa demande de mot de passe, le print, puis le code en SHA1, et le compare a un hash présent en dur dans le code. Si ces hashes sont égaux, le serveur renvoie "Gz, you dumb\*". Sinon, il renvoie "Erm, nope...". En decodant la string présente dans le code, nous obtenons le mot de passe NotSoEasy, qui est donc celui attendu. Cependant, le donner en mot de passe ne marche pas : le serveur renvoie toujours "Erm, nope...", surement parce qu'un \n doit etre ajouté automatiquement.
Entrer le bon mot de passe ne nous avancerait pas beaucoup dans notre quete du flag : il n'est donc pas intéressant d'essayer de rentrer NotSoEasy pour obtenir le bon message du serveur.
Le code contient un print qui contient le mot de passe qui lui est envoyé. On peut donc lui injecter du code et tester si cette piste marche.
En envoyant "`getflag > /tmp/test`", puis en regardant dans le fichier, on y recupere le flag qui permet d'acceder au niveau suivant.
